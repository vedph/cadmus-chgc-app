<form [formGroup]="form" (submit)="save()">
  <mat-card>
    <mat-card-header>
      <div mat-card-avatar>
        <mat-icon>picture_in_picture</mat-icon>
      </div>
      <mat-card-title>CHGC Image Annotations Part</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <mat-tab-group [(selectedIndex)]="tabIndex">
        <!-- annotator -->
        <mat-tab label="annotator">
          <cadmus-gallery-img-annotator
            [image]="image"
            [annotations]="annotations.value"
            [customActions]="actions"
            (annotationsChange)="onAnnotationsChange($any($event))"
            (actionRequest)="onActionRequest($event)"
          ></cadmus-gallery-img-annotator>
          <!-- metadata -->
          <mat-expansion-panel
            [disabled]="!editedAnnotation"
            [expanded]="editedAnnotation"
          >
            <mat-expansion-panel-header>
              <mat-panel-title>
                annotation #{{ editedIndex + 1 }}</mat-panel-title
              ></mat-expansion-panel-header
            >
            <cadmus-chgc-image-annotation
              [idEntries]="idEntries"
              [rendEntries]="rendEntries"
              [annotation]="editedAnnotation"
              (annotationChange)="saveAnnotation()"
            >
            </cadmus-chgc-image-annotation>
          </mat-expansion-panel>
        </mat-tab>

        <!-- gallery -->
        <mat-tab label="gallery">
          <cadmus-gallery-list
            [entries]="filterEntries"
            (imagePick)="onImagePick($event)"
          ></cadmus-gallery-list>
        </mat-tab>
      </mat-tab-group>
    </mat-card-content>
  </mat-card>
  <mat-card-actions>
    <cadmus-close-save-buttons
      [form]="form"
      [noSave]="userLevel < 2"
      (closeRequest)="close()"
    ></cadmus-close-save-buttons>
  </mat-card-actions>
</form>
